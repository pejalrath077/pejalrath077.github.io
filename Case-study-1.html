<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Pejal Rath and Kyle Kuberski" />

<meta name="date" content="2023-03-15" />

<title>Project 1</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Case-study-1.html">Case Study</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Project 1</h1>
<h4 class="author">Pejal Rath and Kyle Kuberski</h4>
<h4 class="date">2023-03-15</h4>

</div>


<pre class="r"><code>#1. How many breweries are present in each state?

library(e1071)
library(tm) #text mining library provides the stopwords() function
library(tidyr)
library(plyr)
library(jsonlite)
library(dplyr)
library(tidyverse)
library(mvtnorm)
library(caret)
library(class)
library(ggplot2)
library(plotly)
library(ggthemes)

beer=read.csv(file.choose(),header = TRUE)
brewer=read.csv(file.choose(),header = TRUE)


brewerByState=brewer %&gt;% count(State)
colnames(brewerByState)[2]=&quot;Count&quot;

brewerByState %&gt;% ggplot(aes(x=State,y=Count,fill=State))+geom_histogram(stat = &quot;summary&quot;) +geom_text(aes(label = Count), vjust = -0.5)+ggtitle(&quot;Breweries Present By Each State&quot;)+ theme_economist()+theme(legend.position = &quot;none&quot;,axis.title = element_text(size = 25),plot.title = element_text(size = 30, face = &quot;bold&quot;))</code></pre>
<pre><code>## Warning in geom_histogram(stat = &quot;summary&quot;): Ignoring unknown parameters: `binwidth`, `bins`, and `pad`</code></pre>
<pre><code>## No summary function supplied, defaulting to `mean_se()`</code></pre>
<p><img src="Case-study-1_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<pre class="r"><code>#3. Address the missing values in each column.
#Fill IBU missing value
set.seed(5)
IBU_na=which(is.na(beer$IBU))
IBU_fill=sample(4:138, 1005,replace=TRUE)
for(i in 1:1005)
{
  beer$IBU[IBU_na[i]]=IBU_fill[i]
}
#Fill ABV missing value
set.seed(5)
ABV_na=which(is.na(beer$ABV))
ABV_fill=sample(0.001:0.128, 62,replace=TRUE)
for(i in 1:62)
{
  beer$ABV[ABV_na[i]]=ABV_fill[i]
}
# Change Ounces to factor type
beer$Ounces=factor(beer$Ounces)

#4. Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.
#2. Join the two table
beer_data &lt;- merge(beer,brewer, by.x=&quot;Brewery_id&quot;,by.y=&quot;Brew_ID&quot;)
colnames(beer_data)[2]=&quot;BeerName&quot;
colnames(beer_data)[8]=&quot;BreweryName&quot;
#beer_data$ABV=as.numeric(beer_data$ABV)
summary_ABVIBU&lt;- beer_data %&gt;% group_by(State) %&gt;% summarize(median_ABV = median(ABV),median_IBU = median(IBU))


summary_ABVIBU %&gt;% ggplot(aes(x=State))+geom_bar(aes(y=median_IBU),stat=&quot;identity&quot;,fill=&quot;Red&quot;)+labs(title = &quot;Median IBU by State&quot;, x = &quot;State&quot;,y = &quot;Median IBU&quot;) +theme_economist()+theme(axis.title = element_text(size = 20))</code></pre>
<p><img src="Case-study-1_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
<pre class="r"><code>summary_ABVIBU %&gt;% ggplot(aes(x=State))+geom_bar(aes(y=median_ABV),stat=&quot;identity&quot;,fill=&quot;blue&quot;)+labs(title = &quot;Median Alcohol Content by State&quot;, x = &quot;State&quot;,y = &quot;Median Alcohol Content&quot;) +theme_economist()+theme(axis.title = element_text(size = 20))</code></pre>
<p><img src="Case-study-1_files/figure-html/unnamed-chunk-1-3.png" width="672" /></p>
<pre class="r"><code>#5
#Max for ABV
beer_data[which.max(beer_data$ABV),]$State</code></pre>
<pre><code>## [1] &quot; CO&quot;</code></pre>
<pre class="r"><code>beer_data[which.max(beer_data$ABV),]$BreweryName</code></pre>
<pre><code>## [1] &quot;Upslope Brewing Company&quot;</code></pre>
<pre class="r"><code>beer_data[which.max(beer_data$ABV),]$BeerName</code></pre>
<pre><code>## [1] &quot;Lee Hill Series Vol. 5 - Belgian Style Quadrupel Ale&quot;</code></pre>
<pre class="r"><code>beer_data[which.max(beer_data$ABV),]$ABV</code></pre>
<pre><code>## [1] 0.128</code></pre>
<pre class="r"><code>#Min for ABV
beer_data[which.min(beer_data$ABV),]$State</code></pre>
<pre><code>## [1] &quot; MI&quot;</code></pre>
<pre class="r"><code>beer_data[which.min(beer_data$ABV),]$BreweryName</code></pre>
<pre><code>## [1] &quot;Brewery Vivant&quot;</code></pre>
<pre class="r"><code>beer_data[which.min(beer_data$ABV),]$BeerName</code></pre>
<pre><code>## [1] &quot;Fat Paczki&quot;</code></pre>
<pre class="r"><code>beer_data[which.min(beer_data$ABV),]$ABV</code></pre>
<pre><code>## [1] 0.001</code></pre>
<pre class="r"><code>#Max for IBU
beer_data[which.max(beer_data$IBU),]$State</code></pre>
<pre><code>## [1] &quot; NY&quot;</code></pre>
<pre class="r"><code>beer_data[which.max(beer_data$IBU),]$BreweryName</code></pre>
<pre><code>## [1] &quot;Sixpoint Craft Ales&quot;</code></pre>
<pre class="r"><code>beer_data[which.max(beer_data$IBU),]$BeerName</code></pre>
<pre><code>## [1] &quot;Abigale&quot;</code></pre>
<pre class="r"><code>beer_data[which.max(beer_data$IBU),]$IBU</code></pre>
<pre><code>## [1] 138</code></pre>
<pre class="r"><code>#Min for IBU
beer_data[which.min(beer_data$IBU),]$State</code></pre>
<pre><code>## [1] &quot; MI&quot;</code></pre>
<pre class="r"><code>beer_data[which.min(beer_data$IBU),]$BreweryName</code></pre>
<pre><code>## [1] &quot;Brewery Vivant&quot;</code></pre>
<pre class="r"><code>beer_data[which.min(beer_data$IBU),]$BeerName</code></pre>
<pre><code>## [1] &quot;Belfort&quot;</code></pre>
<pre class="r"><code>beer_data[which.min(beer_data$IBU),]$IBU</code></pre>
<pre><code>## [1] 4</code></pre>
<pre class="r"><code>max_ABV_IBU&lt;- beer_data %&gt;% group_by(State) %&gt;% summarize(max_ABV = max(ABV),max_IBU = max(IBU))

maxsummary_ABVIBU&lt;- beer_data %&gt;% group_by(State) %&gt;% summarize(max_ABV = max(ABV),max_IBU = max(IBU))

maxsummary_ABVIBU %&gt;% ggplot(aes(x=State))+geom_bar(aes(y=max_ABV),stat=&quot;identity&quot;,fill=&quot;blue&quot;)+labs(title = &quot;ABV Content by State&quot;, x = &quot;State&quot;,y = &quot;Max Alcohol Content&quot;) +theme_bw()</code></pre>
<p><img src="Case-study-1_files/figure-html/unnamed-chunk-1-4.png" width="672" /></p>
<pre class="r"><code>maxsummary_ABVIBU %&gt;% ggplot(aes(x=State))+geom_bar(aes(y=max_IBU),stat=&quot;identity&quot;,fill=&quot;red&quot;)+labs(title = &quot;IBU Content by State&quot;, x = &quot;State&quot;,y = &quot;Max Alcohol Content&quot;) +theme_bw()</code></pre>
<p><img src="Case-study-1_files/figure-html/unnamed-chunk-1-5.png" width="672" /></p>
<pre class="r"><code>#6 summary ABV and distribution of ABV

beer_data[which.min(beer_data$ABV),]$State</code></pre>
<pre><code>## [1] &quot; MI&quot;</code></pre>
<pre class="r"><code>summabv&lt;-summary(beer_data$ABV)

beer_data %&gt;% ggplot(aes(x=ABV)) + geom_histogram(binwidth =0.01, fill = &quot;blue&quot;, col = &quot;black&quot;)+
labs(title = &quot;Summary of ABV Across all States&quot;, x = &quot;Alcohol by Volume (ABV)&quot;, y= &quot;Count&quot;)</code></pre>
<p><img src="Case-study-1_files/figure-html/unnamed-chunk-1-6.png" width="672" /></p>
<pre class="r"><code>ggplot(beer_data, aes(ABV), col=State) + 
  geom_boxplot()</code></pre>
<p><img src="Case-study-1_files/figure-html/unnamed-chunk-1-7.png" width="672" /></p>
<pre class="r"><code>#7 
ggplot(beer_data, aes(x = ABV, y = IBU)) +
  geom_point() +
  labs(x = &quot;Alcohol Content&quot;, y = &quot;Bitterness&quot;)+geom_smooth()</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula = &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="Case-study-1_files/figure-html/unnamed-chunk-1-8.png" width="672" /></p>
<pre class="r"><code># Yes, there is an apparent relationship between the bitterness of the beer and its alcoholic content. Base on visualization, there are evidences to show the higher alcohol content then the beer also has higher IBU.

#8

#create IPA/Ale dataframe 

ipa_ale &lt;- beer %&gt;% filter(grepl(&#39;IPA|Ale&#39;, Style))
ipa_ale$Style &lt;- factor(ifelse(grepl(&quot;IPA&quot;, ipa_ale$Style), &quot;IPA&quot;, &quot;Ale&quot;), levels = c(&quot;Ale&quot;, &quot;IPA&quot;))

##KNN classifier training and test sets
set.seed(123) # for reproducibility
trainIndex &lt;- createDataPartition(ipa_ale$Style, p = .8, list = FALSE)
train &lt;- ipa_ale[trainIndex, ]
test &lt;- ipa_ale[-trainIndex, ]

#set &#39;k&#39; and create model
k &lt;- 3
model &lt;- knn(train[, c(&quot;ABV&quot;, &quot;IBU&quot;)], test = test[, c(&quot;ABV&quot;, &quot;IBU&quot;)], cl = train$Style, k = k)


##levels will not work unless they are the same level and both factors
### Using grepl to check variables for IPA, and assigning it to IPA as a level (same for Ale)
ipa_ale$Style &lt;- factor(ifelse(grepl(&quot;IPA&quot;, ipa_ale$Style), &quot;IPA&quot;, &quot;Ale&quot;), levels = c(&quot;Ale&quot;, &quot;IPA&quot;))

confusionMatrix(model, reference = test$Style)</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction Ale IPA
##        Ale 164  42
##        IPA  28  72
##                                         
##                Accuracy : 0.7712        
##                  95% CI : (0.72, 0.8171)
##     No Information Rate : 0.6275        
##     P-Value [Acc &gt; NIR] : 5.06e-08      
##                                         
##                   Kappa : 0.4982        
##                                         
##  Mcnemar&#39;s Test P-Value : 0.1202        
##                                         
##             Sensitivity : 0.8542        
##             Specificity : 0.6316        
##          Pos Pred Value : 0.7961        
##          Neg Pred Value : 0.7200        
##              Prevalence : 0.6275        
##          Detection Rate : 0.5359        
##    Detection Prevalence : 0.6732        
##       Balanced Accuracy : 0.7429        
##                                         
##        &#39;Positive&#39; Class : Ale           
## </code></pre>
<pre class="r"><code>cmf&lt;- confusionMatrix(model, reference = test$Style)

fourfoldplot(as.table(cmf),color=c(&quot;green&quot;,&quot;red&quot;),main = &quot;Confusion Matrix&quot;)</code></pre>
<p><img src="Case-study-1_files/figure-html/unnamed-chunk-1-9.png" width="672" /></p>
<pre class="r"><code>ggplot(ipa_ale, aes(x = ABV, y = IBU, color = Style)) + 
  geom_point() + 
  labs(title = &quot;Relationship between ABV and IBU for IPAs and Ales&quot;, 
       x = &quot;ABV&quot;, y = &quot;IBU&quot;)</code></pre>
<p><img src="Case-study-1_files/figure-html/unnamed-chunk-1-10.png" width="672" /></p>
<pre class="r"><code>#9
data_ca &lt;- beer_data %&gt;% filter(State==&quot; CO&quot;)
group_style&lt;- data_ca%&gt;% group_by(Style) %&gt;% 
  summarize(count = n()) 

top_5_styles &lt;- group_style %&gt;% 
  top_n(5,count)
  
ggplot(top_5_styles, aes(x = Style, y = count)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;orange&quot;)+geom_text(aes(label = count), vjust = -0.5) +
  xlab(&quot;Beer Style&quot;) +
  ylab(&quot;Count&quot;) +
  ggtitle(&quot;Number of Beers by Style&quot;)+ theme_economist()+theme(legend.position = &quot;none&quot;,axis.title = element_text(size = 25),plot.title = element_text(size = 30, face = &quot;bold&quot;))</code></pre>
<p><img src="Case-study-1_files/figure-html/unnamed-chunk-1-11.png" width="672" /></p>
<pre class="r"><code># Popular size

group_size&lt;- data_ca%&gt;% group_by(Ounces) %&gt;% 
  summarize(count = n()) 

top_5_size &lt;- group_size %&gt;% 
  top_n(5, count)
  
ggplot(top_5_size, aes(x = Ounces, y = count)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;orange&quot;) +geom_text(aes(label = count), vjust = -0.5)+
  xlab(&quot;Beer Size&quot;) +
  ylab(&quot;Count&quot;) +
  ggtitle(&quot;Number of Beers by Size&quot;)+ theme_economist()+theme(legend.position = &quot;none&quot;,axis.title = element_text(size = 25),plot.title = element_text(size = 30, face = &quot;bold&quot;))</code></pre>
<p><img src="Case-study-1_files/figure-html/unnamed-chunk-1-12.png" width="672" /></p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
